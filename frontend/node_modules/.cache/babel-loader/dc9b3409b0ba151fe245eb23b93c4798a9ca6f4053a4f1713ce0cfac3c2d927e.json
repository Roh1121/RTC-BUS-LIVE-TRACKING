{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Rohini\\\\CascadeProjects\\\\rtc-bus-tracking\\\\frontend\\\\src\\\\components\\\\Map\\\\BusTrackingMap.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useState, useCallback } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline, useMap } from 'react-leaflet';\nimport { Icon, DivIcon } from 'leaflet';\nimport io from 'socket.io-client';\nimport TicketIssuer from '../TicketIssuance/TicketIssuer';\n\n// Fix for default markers\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\n// Fix for webpack\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png'\n});\n// Custom bus marker icons based on occupancy status\nconst createBusIcon = (occupancyStatus, isSelected = false) => {\n  const colors = {\n    'green': '#10b981',\n    // Available\n    'yellow': '#f59e0b',\n    // Nearly Full\n    'red': '#ef4444' // Overcrowded\n  };\n  const color = colors[occupancyStatus] || '#3b82f6';\n  const size = isSelected ? 28 : 20;\n  const borderWidth = isSelected ? 3 : 2;\n  return new DivIcon({\n    html: `\n      <div style=\"\n        width: ${size}px;\n        height: ${size}px;\n        background-color: ${color};\n        border: ${borderWidth}px solid white;\n        border-radius: 50%;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 10px;\n        font-weight: bold;\n        color: white;\n      \">\n        ðŸšŒ\n      </div>\n    `,\n    className: 'bus-marker',\n    iconSize: [size, size],\n    iconAnchor: [size / 2, size / 2]\n  });\n};\n\n// Bus stop marker icon\nconst busStopIcon = new Icon({\n  iconUrl: 'data:image/svg+xml;base64,' + btoa(`\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <circle cx=\"10\" cy=\"10\" r=\"8\" fill=\"#3b82f6\" stroke=\"white\" stroke-width=\"2\"/>\n      <circle cx=\"10\" cy=\"10\" r=\"3\" fill=\"white\"/>\n    </svg>\n  `),\n  iconSize: [20, 20],\n  iconAnchor: [10, 10]\n});\n\n// Helper function to convert direction degrees to compass text\nconst getDirectionText = degrees => {\n  const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];\n  const index = Math.round(degrees / 45) % 8;\n  return directions[index];\n};\n\n// Component to update map view when route changes\nconst MapController = ({\n  route\n}) => {\n  _s();\n  const map = useMap();\n  useEffect(() => {\n    if (route && route.stops.length > 0 && map) {\n      try {\n        const bounds = route.stops.map(stop => [stop.coordinates.latitude, stop.coordinates.longitude]);\n\n        // Add a small delay to ensure map is fully initialized\n        setTimeout(() => {\n          if (map.getContainer() && map.getContainer().offsetWidth > 0) {\n            map.fitBounds(bounds, {\n              padding: [20, 20]\n            });\n          }\n        }, 100);\n      } catch (error) {\n        console.warn('Error fitting bounds:', error);\n      }\n    }\n  }, [route, map]);\n  return null;\n};\n_s(MapController, \"IoceErwr5KVGS9kN4RQ1bOkYMAg=\", false, function () {\n  return [useMap];\n});\n_c = MapController;\nexport const BusTrackingMap = ({\n  buses,\n  selectedRoute,\n  center = [17.3850, 78.4867],\n  // Hyderabad coordinates\n  zoom = 12,\n  onBusClick,\n  className = ''\n}) => {\n  _s2();\n  const [busPositions, setBusPositions] = useState(new Map());\n  const [selectedBus, setSelectedBus] = useState(null);\n  const [mapReady, setMapReady] = useState(false);\n  const [ticketIssuerState, setTicketIssuerState] = useState({\n    showTicketIssuer: false,\n    selectedBus: null\n  });\n  const [socket, setSocket] = useState(null);\n\n  // Initialize socket connection\n  useEffect(() => {\n    const newSocket = io('http://localhost:5000');\n    setSocket(newSocket);\n    return () => {\n      newSocket.close();\n    };\n  }, []);\n\n  // Initialize bus positions\n  useEffect(() => {\n    const positions = new Map();\n    buses.forEach(bus => {\n      positions.set(bus._id, bus);\n    });\n    setBusPositions(positions);\n  }, [buses]);\n\n  // Socket event handlers\n  const handleBusLocationUpdate = useCallback(data => {\n    setBusPositions(prev => {\n      const updated = new Map(prev);\n      const existingBus = updated.get(data.busId);\n      if (existingBus) {\n        updated.set(data.busId, {\n          ...existingBus,\n          currentLocation: data.location,\n          speed: data.speed || existingBus.speed,\n          direction: data.direction || existingBus.direction\n        });\n      }\n      return updated;\n    });\n  }, []);\n  const handleBusOccupancyUpdate = useCallback(data => {\n    setBusPositions(prev => {\n      const updated = new Map(prev);\n      const existingBus = updated.get(data.busId);\n      if (existingBus) {\n        updated.set(data.busId, {\n          ...existingBus,\n          occupancy: data.occupancy,\n          occupancyPercentage: data.occupancyPercentage,\n          availableSeats: data.availableSeats\n        });\n      }\n      return updated;\n    });\n  }, []);\n\n  // Socket event listeners\n  useEffect(() => {\n    if (!socket) return;\n    socket.on('busLocationUpdate', handleBusLocationUpdate);\n    socket.on('busOccupancyUpdate', handleBusOccupancyUpdate);\n    return () => {\n      socket.off('busLocationUpdate', handleBusLocationUpdate);\n      socket.off('busOccupancyUpdate', handleBusOccupancyUpdate);\n    };\n  }, [socket, handleBusLocationUpdate, handleBusOccupancyUpdate]);\n  const handleBusMarkerClick = bus => {\n    setSelectedBus(bus._id);\n    onBusClick === null || onBusClick === void 0 ? void 0 : onBusClick(bus);\n  };\n\n  // Generate route polyline coordinates\n  const routeCoordinates = selectedRoute ? selectedRoute.stops.sort((a, b) => a.order - b.order).map(stop => [stop.coordinates.latitude, stop.coordinates.longitude]) : [];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `relative ${className}`,\n    style: {\n      height: '100%',\n      minHeight: '400px'\n    },\n    children: [/*#__PURE__*/_jsxDEV(MapContainer, {\n      center: center,\n      zoom: zoom,\n      className: \"w-full h-full\",\n      zoomControl: true,\n      whenReady: () => {\n        // Add delay to ensure DOM is fully ready\n        setTimeout(() => {\n          setMapReady(true);\n        }, 200);\n      },\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MapController, {\n        route: selectedRoute\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 9\n      }, this), selectedRoute && routeCoordinates.length > 1 && /*#__PURE__*/_jsxDEV(Polyline, {\n        positions: routeCoordinates,\n        color: selectedRoute.color,\n        weight: 4,\n        opacity: 0.7\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 11\n      }, this), selectedRoute === null || selectedRoute === void 0 ? void 0 : selectedRoute.stops.map(stop => /*#__PURE__*/_jsxDEV(Marker, {\n        position: [stop.coordinates.latitude, stop.coordinates.longitude],\n        icon: busStopIcon,\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"font-semibold text-sm\",\n              children: stop.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-gray-600\",\n              children: [\"Stop #\", stop.order]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-gray-600\",\n              children: [\"ETA: \", stop.estimatedTime, \" min from start\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 253,\n              columnNumber: 17\n            }, this), stop.facilities && stop.facilities.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs font-medium\",\n                children: \"Facilities:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 258,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-600\",\n                children: stop.facilities.join(', ')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 259,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 257,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 13\n        }, this)\n      }, stop.stopId, false, {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 11\n      }, this)), mapReady && Array.from(busPositions.values()).map(bus => {\n        try {\n          var _bus$occupancy, _bus$occupancy2;\n          return /*#__PURE__*/_jsxDEV(Marker, {\n            position: [bus.currentLocation.latitude, bus.currentLocation.longitude],\n            icon: createBusIcon(bus.occupancyStatus || 'green', selectedBus === bus._id),\n            eventHandlers: {\n              click: () => handleBusMarkerClick(bus)\n            },\n            children: /*#__PURE__*/_jsxDEV(Popup, {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"p-3 min-w-[200px]\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center justify-between mb-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                    className: \"font-semibold text-lg\",\n                    children: bus.busNumber\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 284,\n                    columnNumber: 19\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: `px-2 py-1 rounded-full text-xs font-medium ${bus.status === 'Active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`,\n                    children: bus.status\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 285,\n                    columnNumber: 19\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 283,\n                  columnNumber: 17\n                }, this), typeof bus.routeId === 'object' && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-gray-600 mb-2\",\n                  children: [\"Route: \", bus.routeId.routeName, \" (\", bus.routeId.routeNumber, \")\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 295,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"space-y-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm font-medium\",\n                      children: \"Current Occupancy\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 302,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"flex items-center space-x-2\",\n                      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                        className: \"flex-1 bg-gray-200 rounded-full h-2\",\n                        children: /*#__PURE__*/_jsxDEV(\"div\", {\n                          className: `h-2 rounded-full ${bus.occupancyStatus === 'green' ? 'bg-green-500' : bus.occupancyStatus === 'yellow' ? 'bg-yellow-500' : 'bg-red-500'}`,\n                          style: {\n                            width: `${bus.occupancyPercentage || 0}%`\n                          }\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 305,\n                          columnNumber: 25\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 304,\n                        columnNumber: 23\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-xs text-gray-600\",\n                        children: [bus.occupancyPercentage || 0, \"%\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 318,\n                        columnNumber: 23\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 303,\n                      columnNumber: 21\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-xs text-gray-600 mt-1\",\n                      children: [bus.totalOccupancy || ((_bus$occupancy = bus.occupancy) === null || _bus$occupancy === void 0 ? void 0 : _bus$occupancy.occupiedSeats) || 0, \"/\", bus.capacity || ((_bus$occupancy2 = bus.occupancy) === null || _bus$occupancy2 === void 0 ? void 0 : _bus$occupancy2.totalSeats) || 0, \" seats (\", bus.availableSeats || 0, \" available)\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 322,\n                      columnNumber: 21\n                    }, this), bus.activeTicketCount && bus.activeTicketCount > 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-xs text-blue-600 mt-1\",\n                      children: [\"+ \", bus.activeTicketCount, \" active tickets\"]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 327,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 301,\n                    columnNumber: 19\n                  }, this), bus.speed !== undefined && /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm font-medium\",\n                      children: \"Speed & Direction\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 335,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm text-gray-600\",\n                      children: [bus.speed, \" km/h\", bus.direction !== undefined && /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"ml-2\",\n                        children: [bus.direction, \"\\xB0 \", getDirectionText(bus.direction)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 339,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 336,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 334,\n                    columnNumber: 21\n                  }, this), bus.estimatedArrival && /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm font-medium\",\n                      children: \"Next Stop ETA\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 349,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm text-gray-600\",\n                      children: [new Date(bus.estimatedArrival).toLocaleTimeString(), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"text-xs text-gray-500 ml-2\",\n                        children: [\"(\", Math.round((new Date(bus.estimatedArrival).getTime() - Date.now()) / 60000), \" min)\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 352,\n                        columnNumber: 25\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 350,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 348,\n                    columnNumber: 21\n                  }, this), bus.driver && /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm font-medium\",\n                      children: \"Driver Contact\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 361,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-sm text-gray-600\",\n                      children: bus.driver.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 362,\n                      columnNumber: 23\n                    }, this), bus.driver.phoneNumber && /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-xs text-blue-600 cursor-pointer hover:underline\",\n                      children: [\"\\uD83D\\uDCDE \", bus.driver.phoneNumber]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 364,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 360,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      className: \"text-xs text-gray-500\",\n                      children: [\"Last updated: \", new Date(bus.currentLocation.lastUpdated || Date.now()).toLocaleTimeString()]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 372,\n                      columnNumber: 21\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 371,\n                    columnNumber: 19\n                  }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"pt-3 border-t border-gray-200\",\n                    children: /*#__PURE__*/_jsxDEV(\"button\", {\n                      onClick: e => {\n                        e.stopPropagation();\n                        setTicketIssuerState({\n                          showTicketIssuer: true,\n                          selectedBus: bus\n                        });\n                      },\n                      className: \"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md text-sm font-medium transition-colors\",\n                      children: \"\\uD83C\\uDFAB Issue Ticket\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 379,\n                      columnNumber: 21\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 378,\n                    columnNumber: 19\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 300,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 282,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 281,\n              columnNumber: 17\n            }, this)\n          }, bus._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 15\n          }, this);\n        } catch (error) {\n          console.warn('Error rendering bus marker:', error);\n          return null;\n        }\n      })]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute bottom-4 right-4 bg-white rounded-lg shadow-lg p-3 z-[1000]\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"text-sm font-semibold mb-2\",\n        children: \"Legend\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 bg-green-500 rounded-full border-2 border-white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 409,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs\",\n            children: \"Available\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 410,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 bg-yellow-500 rounded-full border-2 border-white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 413,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs\",\n            children: \"Nearly Full\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 414,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 412,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 bg-red-500 rounded-full border-2 border-white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs\",\n            children: \"Overcrowded\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 418,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 bg-blue-500 rounded-full border-2 border-white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs\",\n            children: \"Bus Stop\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 422,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 7\n    }, this), ticketIssuerState.showTicketIssuer && ticketIssuerState.selectedBus && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[2000]\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto\",\n        children: /*#__PURE__*/_jsxDEV(TicketIssuer, {\n          bus: ticketIssuerState.selectedBus,\n          onTicketIssued: ticket => {\n            console.log('Ticket issued:', ticket);\n            // Refresh bus data to update occupancy\n            window.location.reload();\n          },\n          onClose: () => setTicketIssuerState({\n            showTicketIssuer: false,\n            selectedBus: null\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 212,\n    columnNumber: 5\n  }, this);\n};\n_s2(BusTrackingMap, \"Qr9DmiMHRu5wC/PUommpccpjUeg=\");\n_c2 = BusTrackingMap;\nvar _c, _c2;\n$RefreshReg$(_c, \"MapController\");\n$RefreshReg$(_c2, \"BusTrackingMap\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","MapContainer","TileLayer","Marker","Popup","Polyline","useMap","Icon","DivIcon","io","TicketIssuer","L","jsxDEV","_jsxDEV","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","createBusIcon","occupancyStatus","isSelected","colors","color","size","borderWidth","html","className","iconSize","iconAnchor","busStopIcon","btoa","getDirectionText","degrees","directions","index","Math","round","MapController","route","_s","map","stops","length","bounds","stop","coordinates","latitude","longitude","setTimeout","getContainer","offsetWidth","fitBounds","padding","error","console","warn","_c","BusTrackingMap","buses","selectedRoute","center","zoom","onBusClick","_s2","busPositions","setBusPositions","Map","selectedBus","setSelectedBus","mapReady","setMapReady","ticketIssuerState","setTicketIssuerState","showTicketIssuer","socket","setSocket","newSocket","close","positions","forEach","bus","set","_id","handleBusLocationUpdate","data","prev","updated","existingBus","get","busId","currentLocation","location","speed","direction","handleBusOccupancyUpdate","occupancy","occupancyPercentage","availableSeats","on","off","handleBusMarkerClick","routeCoordinates","sort","a","b","order","style","height","minHeight","children","zoomControl","whenReady","attribution","url","fileName","_jsxFileName","lineNumber","columnNumber","weight","opacity","position","icon","name","estimatedTime","facilities","join","stopId","Array","from","values","_bus$occupancy","_bus$occupancy2","eventHandlers","click","busNumber","status","routeId","routeName","routeNumber","width","totalOccupancy","occupiedSeats","capacity","totalSeats","activeTicketCount","undefined","estimatedArrival","Date","toLocaleTimeString","getTime","now","driver","phoneNumber","lastUpdated","onClick","e","stopPropagation","onTicketIssued","ticket","log","window","reload","onClose","_c2","$RefreshReg$"],"sources":["C:/Users/Rohini/CascadeProjects/rtc-bus-tracking/frontend/src/components/Map/BusTrackingMap.tsx"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline, useMap } from 'react-leaflet';\nimport { LatLngExpression, Icon, DivIcon } from 'leaflet';\nimport { Bus, Route, BusLocationUpdate, BusOccupancyUpdate } from '../../types';\nimport io from 'socket.io-client';\nimport TicketIssuer from '../TicketIssuance/TicketIssuer';\n\n// Fix for default markers\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\n// Fix for webpack\ndelete (L.Icon.Default.prototype as any)._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',\n});\n\ninterface BusTrackingMapProps {\n  buses: Bus[];\n  selectedRoute?: Route;\n  center?: LatLngExpression;\n  zoom?: number;\n  onBusClick?: (bus: Bus) => void;\n  className?: string;\n}\n\ninterface BusMarkerState {\n  showTicketIssuer: boolean;\n  selectedBus: Bus | null;\n}\n\n// Custom bus marker icons based on occupancy status\nconst createBusIcon = (occupancyStatus: string, isSelected: boolean = false) => {\n  const colors = {\n    'green': '#10b981',     // Available\n    'yellow': '#f59e0b',    // Nearly Full\n    'red': '#ef4444',       // Overcrowded\n  };\n\n  const color = colors[occupancyStatus as keyof typeof colors] || '#3b82f6';\n  const size = isSelected ? 28 : 20;\n  const borderWidth = isSelected ? 3 : 2;\n\n  return new DivIcon({\n    html: `\n      <div style=\"\n        width: ${size}px;\n        height: ${size}px;\n        background-color: ${color};\n        border: ${borderWidth}px solid white;\n        border-radius: 50%;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 10px;\n        font-weight: bold;\n        color: white;\n      \">\n        ðŸšŒ\n      </div>\n    `,\n    className: 'bus-marker',\n    iconSize: [size, size],\n    iconAnchor: [size / 2, size / 2],\n  });\n};\n\n// Bus stop marker icon\nconst busStopIcon = new Icon({\n  iconUrl: 'data:image/svg+xml;base64,' + btoa(`\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <circle cx=\"10\" cy=\"10\" r=\"8\" fill=\"#3b82f6\" stroke=\"white\" stroke-width=\"2\"/>\n      <circle cx=\"10\" cy=\"10\" r=\"3\" fill=\"white\"/>\n    </svg>\n  `),\n  iconSize: [20, 20],\n  iconAnchor: [10, 10],\n});\n\n// Helper function to convert direction degrees to compass text\nconst getDirectionText = (degrees: number): string => {\n  const directions = ['N', 'NE', 'E', 'SE', 'S', 'SW', 'W', 'NW'];\n  const index = Math.round(degrees / 45) % 8;\n  return directions[index];\n};\n\n// Component to update map view when route changes\nconst MapController: React.FC<{ route?: Route }> = ({ route }) => {\n  const map = useMap();\n\n  useEffect(() => {\n    if (route && route.stops.length > 0 && map) {\n      try {\n        const bounds = route.stops.map(stop => [\n          stop.coordinates.latitude,\n          stop.coordinates.longitude\n        ] as [number, number]);\n        \n        // Add a small delay to ensure map is fully initialized\n        setTimeout(() => {\n          if (map.getContainer() && map.getContainer().offsetWidth > 0) {\n            map.fitBounds(bounds, { padding: [20, 20] });\n          }\n        }, 100);\n      } catch (error) {\n        console.warn('Error fitting bounds:', error);\n      }\n    }\n  }, [route, map]);\n\n  return null;\n};\n\nexport const BusTrackingMap: React.FC<BusTrackingMapProps> = ({\n  buses,\n  selectedRoute,\n  center = [17.3850, 78.4867], // Hyderabad coordinates\n  zoom = 12,\n  onBusClick,\n  className = ''\n}) => {\n  const [busPositions, setBusPositions] = useState<Map<string, Bus>>(new Map());\n  const [selectedBus, setSelectedBus] = useState<string | null>(null);\n  const [mapReady, setMapReady] = useState(false);\n  const [ticketIssuerState, setTicketIssuerState] = useState<BusMarkerState>({\n    showTicketIssuer: false,\n    selectedBus: null\n  });\n  const [socket, setSocket] = useState<any>(null);\n\n  // Initialize socket connection\n  useEffect(() => {\n    const newSocket = io('http://localhost:5000');\n    setSocket(newSocket);\n\n    return () => {\n      newSocket.close();\n    };\n  }, []);\n\n  // Initialize bus positions\n  useEffect(() => {\n    const positions = new Map<string, Bus>();\n    buses.forEach(bus => {\n      positions.set(bus._id, bus);\n    });\n    setBusPositions(positions);\n  }, [buses]);\n\n  // Socket event handlers\n  const handleBusLocationUpdate = useCallback((data: BusLocationUpdate) => {\n    setBusPositions(prev => {\n      const updated = new Map(prev);\n      const existingBus = updated.get(data.busId);\n      if (existingBus) {\n        updated.set(data.busId, {\n          ...existingBus,\n          currentLocation: data.location,\n          speed: data.speed || (existingBus as any).speed,\n          direction: data.direction || (existingBus as any).direction,\n        });\n      }\n      return updated;\n    });\n  }, []);\n\n  const handleBusOccupancyUpdate = useCallback((data: BusOccupancyUpdate) => {\n    setBusPositions(prev => {\n      const updated = new Map(prev);\n      const existingBus = updated.get(data.busId);\n      if (existingBus) {\n        updated.set(data.busId, {\n          ...existingBus,\n          occupancy: data.occupancy,\n          occupancyPercentage: data.occupancyPercentage,\n          availableSeats: data.availableSeats,\n        });\n      }\n      return updated;\n    });\n  }, []);\n\n  // Socket event listeners\n  useEffect(() => {\n    if (!socket) return;\n\n    socket.on('busLocationUpdate', handleBusLocationUpdate);\n    socket.on('busOccupancyUpdate', handleBusOccupancyUpdate);\n\n    return () => {\n      socket.off('busLocationUpdate', handleBusLocationUpdate);\n      socket.off('busOccupancyUpdate', handleBusOccupancyUpdate);\n    };\n  }, [socket, handleBusLocationUpdate, handleBusOccupancyUpdate]);\n\n  const handleBusMarkerClick = (bus: Bus) => {\n    setSelectedBus(bus._id);\n    onBusClick?.(bus);\n  };\n\n  // Generate route polyline coordinates\n  const routeCoordinates: LatLngExpression[] = selectedRoute\n    ? selectedRoute.stops\n        .sort((a, b) => a.order - b.order)\n        .map(stop => [stop.coordinates.latitude, stop.coordinates.longitude])\n    : [];\n\n  return (\n    <div className={`relative ${className}`} style={{ height: '100%', minHeight: '400px' }}>\n      <MapContainer\n        center={center}\n        zoom={zoom}\n        className=\"w-full h-full\"\n        zoomControl={true}\n        whenReady={() => {\n          // Add delay to ensure DOM is fully ready\n          setTimeout(() => {\n            setMapReady(true);\n          }, 200);\n        }}\n      >\n        <TileLayer\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n\n        <MapController route={selectedRoute} />\n\n        {/* Route polyline */}\n        {selectedRoute && routeCoordinates.length > 1 && (\n          <Polyline\n            positions={routeCoordinates}\n            color={selectedRoute.color}\n            weight={4}\n            opacity={0.7}\n          />\n        )}\n\n        {/* Bus stop markers */}\n        {selectedRoute?.stops.map((stop) => (\n          <Marker\n            key={stop.stopId}\n            position={[stop.coordinates.latitude, stop.coordinates.longitude]}\n            icon={busStopIcon}\n          >\n            <Popup>\n              <div className=\"p-2\">\n                <h3 className=\"font-semibold text-sm\">{stop.name}</h3>\n                <p className=\"text-xs text-gray-600\">Stop #{stop.order}</p>\n                <p className=\"text-xs text-gray-600\">\n                  ETA: {stop.estimatedTime} min from start\n                </p>\n                {stop.facilities && stop.facilities.length > 0 && (\n                  <div className=\"mt-1\">\n                    <p className=\"text-xs font-medium\">Facilities:</p>\n                    <p className=\"text-xs text-gray-600\">\n                      {stop.facilities.join(', ')}\n                    </p>\n                  </div>\n                )}\n              </div>\n            </Popup>\n          </Marker>\n        ))}\n\n        {/* Bus markers */}\n        {mapReady && Array.from(busPositions.values()).map((bus: Bus) => {\n          try {\n            return (\n              <Marker\n                key={bus._id}\n                position={[bus.currentLocation.latitude, bus.currentLocation.longitude]}\n                icon={createBusIcon(bus.occupancyStatus || 'green', selectedBus === bus._id)}\n                eventHandlers={{\n                  click: () => handleBusMarkerClick(bus),\n                }}\n              >\n                <Popup>\n              <div className=\"p-3 min-w-[200px]\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <h3 className=\"font-semibold text-lg\">{bus.busNumber}</h3>\n                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                    bus.status === 'Active' \n                      ? 'bg-green-100 text-green-800'\n                      : 'bg-red-100 text-red-800'\n                  }`}>\n                    {bus.status}\n                  </span>\n                </div>\n\n                {typeof bus.routeId === 'object' && (\n                  <p className=\"text-sm text-gray-600 mb-2\">\n                    Route: {bus.routeId.routeName} ({bus.routeId.routeNumber})\n                  </p>\n                )}\n\n                <div className=\"space-y-2\">\n                  <div>\n                    <p className=\"text-sm font-medium\">Current Occupancy</p>\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\n                        <div\n                          className={`h-2 rounded-full ${\n                            bus.occupancyStatus === 'green'\n                              ? 'bg-green-500'\n                              : bus.occupancyStatus === 'yellow'\n                              ? 'bg-yellow-500'\n                              : 'bg-red-500'\n                          }`}\n                          style={{\n                            width: `${bus.occupancyPercentage || 0}%`,\n                          }}\n                        />\n                      </div>\n                      <span className=\"text-xs text-gray-600\">\n                        {bus.occupancyPercentage || 0}%\n                      </span>\n                    </div>\n                    <p className=\"text-xs text-gray-600 mt-1\">\n                      {bus.totalOccupancy || bus.occupancy?.occupiedSeats || 0}/{bus.capacity || bus.occupancy?.totalSeats || 0} seats\n                      ({bus.availableSeats || 0} available)\n                    </p>\n                    {bus.activeTicketCount && bus.activeTicketCount > 0 && (\n                      <p className=\"text-xs text-blue-600 mt-1\">\n                        + {bus.activeTicketCount} active tickets\n                      </p>\n                    )}\n                  </div>\n\n                  {bus.speed !== undefined && (\n                    <div>\n                      <p className=\"text-sm font-medium\">Speed & Direction</p>\n                      <p className=\"text-sm text-gray-600\">\n                        {bus.speed} km/h\n                        {bus.direction !== undefined && (\n                          <span className=\"ml-2\">\n                            {bus.direction}Â° {getDirectionText(bus.direction)}\n                          </span>\n                        )}\n                      </p>\n                    </div>\n                  )}\n\n                  {bus.estimatedArrival && (\n                    <div>\n                      <p className=\"text-sm font-medium\">Next Stop ETA</p>\n                      <p className=\"text-sm text-gray-600\">\n                        {new Date(bus.estimatedArrival).toLocaleTimeString()}\n                        <span className=\"text-xs text-gray-500 ml-2\">\n                          ({Math.round((new Date(bus.estimatedArrival).getTime() - Date.now()) / 60000)} min)\n                        </span>\n                      </p>\n                    </div>\n                  )}\n\n                  {bus.driver && (\n                    <div>\n                      <p className=\"text-sm font-medium\">Driver Contact</p>\n                      <p className=\"text-sm text-gray-600\">{bus.driver.name}</p>\n                      {bus.driver.phoneNumber && (\n                        <p className=\"text-xs text-blue-600 cursor-pointer hover:underline\">\n                          ðŸ“ž {bus.driver.phoneNumber}\n                        </p>\n                      )}\n                    </div>\n                  )}\n\n                  <div>\n                    <p className=\"text-xs text-gray-500\">\n                      Last updated: {new Date(bus.currentLocation.lastUpdated || Date.now()).toLocaleTimeString()}\n                    </p>\n                  </div>\n\n                  {/* Issue Ticket Button */}\n                  <div className=\"pt-3 border-t border-gray-200\">\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        setTicketIssuerState({\n                          showTicketIssuer: true,\n                          selectedBus: bus\n                        });\n                      }}\n                      className=\"w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-md text-sm font-medium transition-colors\"\n                    >\n                      ðŸŽ« Issue Ticket\n                    </button>\n                  </div>\n                </div>\n              </div>\n                </Popup>\n              </Marker>\n            );\n          } catch (error) {\n            console.warn('Error rendering bus marker:', error);\n            return null;\n          }\n        })}\n      </MapContainer>\n\n      {/* Map legend */}\n      <div className=\"absolute bottom-4 right-4 bg-white rounded-lg shadow-lg p-3 z-[1000]\">\n        <h4 className=\"text-sm font-semibold mb-2\">Legend</h4>\n        <div className=\"space-y-1\">\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-4 h-4 bg-green-500 rounded-full border-2 border-white\"></div>\n            <span className=\"text-xs\">Available</span>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-4 h-4 bg-yellow-500 rounded-full border-2 border-white\"></div>\n            <span className=\"text-xs\">Nearly Full</span>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-4 h-4 bg-red-500 rounded-full border-2 border-white\"></div>\n            <span className=\"text-xs\">Overcrowded</span>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-4 h-4 bg-blue-500 rounded-full border-2 border-white\"></div>\n            <span className=\"text-xs\">Bus Stop</span>\n          </div>\n        </div>\n      </div>\n\n      {/* Ticket Issuer Modal */}\n      {ticketIssuerState.showTicketIssuer && ticketIssuerState.selectedBus && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[2000]\">\n          <div className=\"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto\">\n            <TicketIssuer\n              bus={ticketIssuerState.selectedBus}\n              onTicketIssued={(ticket) => {\n                console.log('Ticket issued:', ticket);\n                // Refresh bus data to update occupancy\n                window.location.reload();\n              }}\n              onClose={() => setTicketIssuerState({\n                showTicketIssuer: false,\n                selectedBus: null\n              })}\n            />\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}