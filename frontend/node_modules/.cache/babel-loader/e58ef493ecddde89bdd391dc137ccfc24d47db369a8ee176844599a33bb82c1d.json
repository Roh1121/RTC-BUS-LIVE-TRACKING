{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Rohini\\\\CascadeProjects\\\\rtc-bus-tracking\\\\frontend\\\\src\\\\components\\\\Map\\\\BusTrackingMap.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useState, useCallback, useRef } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline, useMap } from 'react-leaflet';\nimport { Icon, DivIcon } from 'leaflet';\nimport { useSocket } from '../../hooks/useSocket';\n\n// Fix for default markers\nimport L from 'leaflet';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\n  iconUrl: require('leaflet/dist/images/marker-icon.png'),\n  shadowUrl: require('leaflet/dist/images/marker-shadow.png')\n});\n// Custom bus marker icons\nconst createBusIcon = (occupancyStatus, isSelected = false) => {\n  const colors = {\n    'Available': '#10b981',\n    'Nearly Full': '#f59e0b',\n    'Overcrowded': '#ef4444'\n  };\n  const color = colors[occupancyStatus] || '#3b82f6';\n  const size = isSelected ? 24 : 18;\n  const borderWidth = isSelected ? 3 : 2;\n  return new DivIcon({\n    html: `\n      <div style=\"\n        width: ${size}px;\n        height: ${size}px;\n        background-color: ${color};\n        border: ${borderWidth}px solid white;\n        border-radius: 50%;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 10px;\n        font-weight: bold;\n        color: white;\n      \">\n        ðŸšŒ\n      </div>\n    `,\n    className: 'bus-marker',\n    iconSize: [size, size],\n    iconAnchor: [size / 2, size / 2]\n  });\n};\n\n// Bus stop marker icon\nconst busStopIcon = new Icon({\n  iconUrl: 'data:image/svg+xml;base64,' + btoa(`\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <circle cx=\"10\" cy=\"10\" r=\"8\" fill=\"#3b82f6\" stroke=\"white\" stroke-width=\"2\"/>\n      <circle cx=\"10\" cy=\"10\" r=\"3\" fill=\"white\"/>\n    </svg>\n  `),\n  iconSize: [20, 20],\n  iconAnchor: [10, 10]\n});\n\n// Component to update map view when route changes\nconst MapController = ({\n  route\n}) => {\n  _s();\n  const map = useMap();\n  useEffect(() => {\n    if (route && route.stops.length > 0) {\n      const bounds = route.stops.map(stop => [stop.coordinates.latitude, stop.coordinates.longitude]);\n      map.fitBounds(bounds, {\n        padding: [20, 20]\n      });\n    }\n  }, [route, map]);\n  return null;\n};\n_s(MapController, \"IoceErwr5KVGS9kN4RQ1bOkYMAg=\", false, function () {\n  return [useMap];\n});\n_c = MapController;\nexport const BusTrackingMap = ({\n  buses,\n  selectedRoute,\n  center = [17.3850, 78.4867],\n  // Hyderabad coordinates\n  zoom = 12,\n  onBusClick,\n  className = ''\n}) => {\n  _s2();\n  const [mapBuses, setMapBuses] = useState(buses);\n  const [mapReady, setMapReady] = useState(false);\n  const mapRef = useRef(null);\n  const socket = useSocket();\n\n  // Update buses when props change\n  useEffect(() => {\n    setMapBuses(buses);\n  }, [buses]);\n\n  // Initialize bus positions\n  useEffect(() => {\n    const positions = new Map();\n    buses.forEach(bus => {\n      positions.set(bus._id, bus);\n    });\n    setBusPositions(positions);\n  }, [buses]);\n\n  // Socket event handlers\n  const handleBusLocationUpdate = useCallback(data => {\n    setBusPositions(prev => {\n      const updated = new Map(prev);\n      const existingBus = updated.get(data.busId);\n      if (existingBus) {\n        updated.set(data.busId, {\n          ...existingBus,\n          currentLocation: data.location,\n          speed: data.speed || existingBus.speed,\n          direction: data.direction || existingBus.direction\n        });\n      }\n      return updated;\n    });\n  }, []);\n  const handleBusOccupancyUpdate = useCallback(data => {\n    setBusPositions(prev => {\n      const updated = new Map(prev);\n      const existingBus = updated.get(data.busId);\n      if (existingBus) {\n        updated.set(data.busId, {\n          ...existingBus,\n          occupancy: data.occupancy,\n          occupancyPercentage: data.occupancyPercentage,\n          availableSeats: data.availableSeats\n        });\n      }\n      return updated;\n    });\n  }, []);\n\n  // Use socket hook\n  useSocket({\n    onBusLocationUpdate: handleBusLocationUpdate,\n    onBusOccupancyUpdate: handleBusOccupancyUpdate\n  });\n  const handleBusMarkerClick = bus => {\n    setSelectedBus(bus._id);\n    onBusClick === null || onBusClick === void 0 ? void 0 : onBusClick(bus);\n  };\n\n  // Generate route polyline coordinates\n  const routeCoordinates = selectedRoute ? selectedRoute.stops.sort((a, b) => a.order - b.order).map(stop => [stop.coordinates.latitude, stop.coordinates.longitude]) : [];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `relative ${className}`,\n    children: [/*#__PURE__*/_jsxDEV(MapContainer, {\n      center: center,\n      zoom: zoom,\n      className: \"w-full h-full\",\n      zoomControl: true,\n      children: [/*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MapController, {\n        route: selectedRoute\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 182,\n        columnNumber: 9\n      }, this), selectedRoute && routeCoordinates.length > 1 && /*#__PURE__*/_jsxDEV(Polyline, {\n        positions: routeCoordinates,\n        color: selectedRoute.color,\n        weight: 4,\n        opacity: 0.7\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 11\n      }, this), selectedRoute === null || selectedRoute === void 0 ? void 0 : selectedRoute.stops.map(stop => /*#__PURE__*/_jsxDEV(Marker, {\n        position: [stop.coordinates.latitude, stop.coordinates.longitude],\n        icon: busStopIcon,\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"font-semibold text-sm\",\n              children: stop.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 203,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-gray-600\",\n              children: [\"Stop #\", stop.order]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-xs text-gray-600\",\n              children: [\"ETA: \", stop.estimatedTime, \" min from start\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 205,\n              columnNumber: 17\n            }, this), stop.facilities && stop.facilities.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-1\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs font-medium\",\n                children: \"Facilities:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 210,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-xs text-gray-600\",\n                children: stop.facilities.join(', ')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 211,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 13\n        }, this)\n      }, stop.stopId, false, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 11\n      }, this)), Array.from(busPositions.values()).map(bus => /*#__PURE__*/_jsxDEV(Marker, {\n        position: [bus.currentLocation.latitude, bus.currentLocation.longitude],\n        icon: createBusIcon(bus.occupancy.status, selectedBus === bus._id),\n        eventHandlers: {\n          click: () => handleBusMarkerClick(bus)\n        },\n        children: /*#__PURE__*/_jsxDEV(Popup, {\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-3 min-w-[200px]\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-between mb-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                className: \"font-semibold text-lg\",\n                children: bus.busNumber\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `px-2 py-1 rounded-full text-xs font-medium ${bus.status === 'Active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`,\n                children: bus.status\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 235,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 17\n            }, this), typeof bus.routeId === 'object' && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-sm text-gray-600 mb-2\",\n              children: [\"Route: \", bus.routeId.routeName, \" (\", bus.routeId.routeNumber, \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm font-medium\",\n                  children: \"Occupancy\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 252,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex items-center space-x-2\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"flex-1 bg-gray-200 rounded-full h-2\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: `h-2 rounded-full ${bus.occupancy.status === 'Available' ? 'bg-green-500' : bus.occupancy.status === 'Nearly Full' ? 'bg-yellow-500' : 'bg-red-500'}`,\n                      style: {\n                        width: `${bus.occupancyPercentage || 0}%`\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 255,\n                      columnNumber: 25\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 254,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-xs text-gray-600\",\n                    children: [bus.occupancyPercentage || 0, \"%\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 268,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 253,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs text-gray-600 mt-1\",\n                  children: [bus.occupancy.occupiedSeats, \"/\", bus.occupancy.totalSeats, \" seats (\", bus.availableSeats || 0, \" available)\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 272,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 251,\n                columnNumber: 19\n              }, this), bus.speed !== undefined && /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm font-medium\",\n                  children: \"Speed\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 280,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-gray-600\",\n                  children: [bus.speed, \" km/h\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 281,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 279,\n                columnNumber: 21\n              }, this), bus.driver && /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm font-medium\",\n                  children: \"Driver\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 287,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-sm text-gray-600\",\n                  children: bus.driver.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 288,\n                  columnNumber: 23\n                }, this), bus.driver.phoneNumber && /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs text-gray-500\",\n                  children: bus.driver.phoneNumber\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 290,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 286,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"text-xs text-gray-500\",\n                  children: [\"Last updated: \", new Date(bus.currentLocation.lastUpdated || Date.now()).toLocaleTimeString()]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 296,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 295,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 13\n        }, this)\n      }, bus._id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute bottom-4 right-4 bg-white rounded-lg shadow-lg p-3 z-[1000]\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"text-sm font-semibold mb-2\",\n        children: \"Legend\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"space-y-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 bg-green-500 rounded-full border-2 border-white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs\",\n            children: \"Available\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 311,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 bg-yellow-500 rounded-full border-2 border-white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs\",\n            children: \"Nearly Full\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 bg-red-500 rounded-full border-2 border-white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs\",\n            children: \"Overcrowded\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-4 h-4 bg-blue-500 rounded-full border-2 border-white\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-xs\",\n            children: \"Bus Stop\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 310,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 170,\n    columnNumber: 5\n  }, this);\n};\n_s2(BusTrackingMap, \"QX3ZdANM+yHxibcw6k3foph9MMA=\", false, function () {\n  return [useSocket, useSocket];\n});\n_c2 = BusTrackingMap;\nvar _c, _c2;\n$RefreshReg$(_c, \"MapController\");\n$RefreshReg$(_c2, \"BusTrackingMap\");","map":{"version":3,"names":["React","useEffect","useState","useCallback","useRef","MapContainer","TileLayer","Marker","Popup","Polyline","useMap","Icon","DivIcon","useSocket","L","jsxDEV","_jsxDEV","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","require","iconUrl","shadowUrl","createBusIcon","occupancyStatus","isSelected","colors","color","size","borderWidth","html","className","iconSize","iconAnchor","busStopIcon","btoa","MapController","route","_s","map","stops","length","bounds","stop","coordinates","latitude","longitude","fitBounds","padding","_c","BusTrackingMap","buses","selectedRoute","center","zoom","onBusClick","_s2","mapBuses","setMapBuses","mapReady","setMapReady","mapRef","socket","positions","Map","forEach","bus","set","_id","setBusPositions","handleBusLocationUpdate","data","prev","updated","existingBus","get","busId","currentLocation","location","speed","direction","handleBusOccupancyUpdate","occupancy","occupancyPercentage","availableSeats","onBusLocationUpdate","onBusOccupancyUpdate","handleBusMarkerClick","setSelectedBus","routeCoordinates","sort","a","b","order","children","zoomControl","attribution","url","fileName","_jsxFileName","lineNumber","columnNumber","weight","opacity","position","icon","name","estimatedTime","facilities","join","stopId","Array","from","busPositions","values","status","selectedBus","eventHandlers","click","busNumber","routeId","routeName","routeNumber","style","width","occupiedSeats","totalSeats","undefined","driver","phoneNumber","Date","lastUpdated","now","toLocaleTimeString","_c2","$RefreshReg$"],"sources":["C:/Users/Rohini/CascadeProjects/rtc-bus-tracking/frontend/src/components/Map/BusTrackingMap.tsx"],"sourcesContent":["import React, { useEffect, useState, useCallback, useRef } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup, Polyline, useMap } from 'react-leaflet';\nimport { LatLngExpression, Icon, DivIcon } from 'leaflet';\nimport { Bus, Route, BusLocationUpdate, BusOccupancyUpdate } from '../../types';\nimport { useSocket } from '../../hooks/useSocket';\n\n// Fix for default markers\nimport L from 'leaflet';\ndelete (L.Icon.Default.prototype as any)._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\n  iconUrl: require('leaflet/dist/images/marker-icon.png'),\n  shadowUrl: require('leaflet/dist/images/marker-shadow.png'),\n});\n\ninterface BusTrackingMapProps {\n  buses: Bus[];\n  selectedRoute?: Route;\n  center?: LatLngExpression;\n  zoom?: number;\n  onBusClick?: (bus: Bus) => void;\n  className?: string;\n}\n\n// Custom bus marker icons\nconst createBusIcon = (occupancyStatus: string, isSelected: boolean = false) => {\n  const colors = {\n    'Available': '#10b981',\n    'Nearly Full': '#f59e0b',\n    'Overcrowded': '#ef4444',\n  };\n\n  const color = colors[occupancyStatus as keyof typeof colors] || '#3b82f6';\n  const size = isSelected ? 24 : 18;\n  const borderWidth = isSelected ? 3 : 2;\n\n  return new DivIcon({\n    html: `\n      <div style=\"\n        width: ${size}px;\n        height: ${size}px;\n        background-color: ${color};\n        border: ${borderWidth}px solid white;\n        border-radius: 50%;\n        box-shadow: 0 2px 4px rgba(0,0,0,0.3);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 10px;\n        font-weight: bold;\n        color: white;\n      \">\n        ðŸšŒ\n      </div>\n    `,\n    className: 'bus-marker',\n    iconSize: [size, size],\n    iconAnchor: [size / 2, size / 2],\n  });\n};\n\n// Bus stop marker icon\nconst busStopIcon = new Icon({\n  iconUrl: 'data:image/svg+xml;base64,' + btoa(`\n    <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n      <circle cx=\"10\" cy=\"10\" r=\"8\" fill=\"#3b82f6\" stroke=\"white\" stroke-width=\"2\"/>\n      <circle cx=\"10\" cy=\"10\" r=\"3\" fill=\"white\"/>\n    </svg>\n  `),\n  iconSize: [20, 20],\n  iconAnchor: [10, 10],\n});\n\n// Component to update map view when route changes\nconst MapController: React.FC<{ route?: Route }> = ({ route }) => {\n  const map = useMap();\n\n  useEffect(() => {\n    if (route && route.stops.length > 0) {\n      const bounds = route.stops.map(stop => [\n        stop.coordinates.latitude,\n        stop.coordinates.longitude\n      ] as [number, number]);\n      map.fitBounds(bounds, { padding: [20, 20] });\n    }\n  }, [route, map]);\n\n  return null;\n};\n\nexport const BusTrackingMap: React.FC<BusTrackingMapProps> = ({\n  buses,\n  selectedRoute,\n  center = [17.3850, 78.4867], // Hyderabad coordinates\n  zoom = 12,\n  onBusClick,\n  className = ''\n}) => {\n  const [mapBuses, setMapBuses] = useState<Bus[]>(buses);\n  const [mapReady, setMapReady] = useState(false);\n  const mapRef = useRef<L.Map | null>(null);\n  const socket = useSocket();\n\n  // Update buses when props change\n  useEffect(() => {\n    setMapBuses(buses);\n  }, [buses]);\n\n  // Initialize bus positions\n  useEffect(() => {\n    const positions = new Map();\n    buses.forEach(bus => {\n      positions.set(bus._id, bus);\n    });\n    setBusPositions(positions);\n  }, [buses]);\n\n  // Socket event handlers\n  const handleBusLocationUpdate = useCallback((data: BusLocationUpdate) => {\n    setBusPositions(prev => {\n      const updated = new Map(prev);\n      const existingBus = updated.get(data.busId);\n      if (existingBus) {\n        updated.set(data.busId, {\n          ...existingBus,\n          currentLocation: data.location,\n          speed: data.speed || existingBus.speed,\n          direction: data.direction || existingBus.direction,\n        });\n      }\n      return updated;\n    });\n  }, []);\n\n  const handleBusOccupancyUpdate = useCallback((data: BusOccupancyUpdate) => {\n    setBusPositions(prev => {\n      const updated = new Map(prev);\n      const existingBus = updated.get(data.busId);\n      if (existingBus) {\n        updated.set(data.busId, {\n          ...existingBus,\n          occupancy: data.occupancy,\n          occupancyPercentage: data.occupancyPercentage,\n          availableSeats: data.availableSeats,\n        });\n      }\n      return updated;\n    });\n  }, []);\n\n  // Use socket hook\n  useSocket({\n    onBusLocationUpdate: handleBusLocationUpdate,\n    onBusOccupancyUpdate: handleBusOccupancyUpdate,\n  });\n\n  const handleBusMarkerClick = (bus: Bus) => {\n    setSelectedBus(bus._id);\n    onBusClick?.(bus);\n  };\n\n  // Generate route polyline coordinates\n  const routeCoordinates: LatLngExpression[] = selectedRoute\n    ? selectedRoute.stops\n        .sort((a, b) => a.order - b.order)\n        .map(stop => [stop.coordinates.latitude, stop.coordinates.longitude])\n    : [];\n\n  return (\n    <div className={`relative ${className}`}>\n      <MapContainer\n        center={center}\n        zoom={zoom}\n        className=\"w-full h-full\"\n        zoomControl={true}\n      >\n        <TileLayer\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n\n        <MapController route={selectedRoute} />\n\n        {/* Route polyline */}\n        {selectedRoute && routeCoordinates.length > 1 && (\n          <Polyline\n            positions={routeCoordinates}\n            color={selectedRoute.color}\n            weight={4}\n            opacity={0.7}\n          />\n        )}\n\n        {/* Bus stop markers */}\n        {selectedRoute?.stops.map((stop) => (\n          <Marker\n            key={stop.stopId}\n            position={[stop.coordinates.latitude, stop.coordinates.longitude]}\n            icon={busStopIcon}\n          >\n            <Popup>\n              <div className=\"p-2\">\n                <h3 className=\"font-semibold text-sm\">{stop.name}</h3>\n                <p className=\"text-xs text-gray-600\">Stop #{stop.order}</p>\n                <p className=\"text-xs text-gray-600\">\n                  ETA: {stop.estimatedTime} min from start\n                </p>\n                {stop.facilities && stop.facilities.length > 0 && (\n                  <div className=\"mt-1\">\n                    <p className=\"text-xs font-medium\">Facilities:</p>\n                    <p className=\"text-xs text-gray-600\">\n                      {stop.facilities.join(', ')}\n                    </p>\n                  </div>\n                )}\n              </div>\n            </Popup>\n          </Marker>\n        ))}\n\n        {/* Bus markers */}\n        {Array.from(busPositions.values()).map((bus) => (\n          <Marker\n            key={bus._id}\n            position={[bus.currentLocation.latitude, bus.currentLocation.longitude]}\n            icon={createBusIcon(bus.occupancy.status, selectedBus === bus._id)}\n            eventHandlers={{\n              click: () => handleBusMarkerClick(bus),\n            }}\n          >\n            <Popup>\n              <div className=\"p-3 min-w-[200px]\">\n                <div className=\"flex items-center justify-between mb-2\">\n                  <h3 className=\"font-semibold text-lg\">{bus.busNumber}</h3>\n                  <span className={`px-2 py-1 rounded-full text-xs font-medium ${\n                    bus.status === 'Active' \n                      ? 'bg-green-100 text-green-800'\n                      : 'bg-red-100 text-red-800'\n                  }`}>\n                    {bus.status}\n                  </span>\n                </div>\n\n                {typeof bus.routeId === 'object' && (\n                  <p className=\"text-sm text-gray-600 mb-2\">\n                    Route: {bus.routeId.routeName} ({bus.routeId.routeNumber})\n                  </p>\n                )}\n\n                <div className=\"space-y-2\">\n                  <div>\n                    <p className=\"text-sm font-medium\">Occupancy</p>\n                    <div className=\"flex items-center space-x-2\">\n                      <div className=\"flex-1 bg-gray-200 rounded-full h-2\">\n                        <div\n                          className={`h-2 rounded-full ${\n                            bus.occupancy.status === 'Available'\n                              ? 'bg-green-500'\n                              : bus.occupancy.status === 'Nearly Full'\n                              ? 'bg-yellow-500'\n                              : 'bg-red-500'\n                          }`}\n                          style={{\n                            width: `${bus.occupancyPercentage || 0}%`,\n                          }}\n                        />\n                      </div>\n                      <span className=\"text-xs text-gray-600\">\n                        {bus.occupancyPercentage || 0}%\n                      </span>\n                    </div>\n                    <p className=\"text-xs text-gray-600 mt-1\">\n                      {bus.occupancy.occupiedSeats}/{bus.occupancy.totalSeats} seats\n                      ({bus.availableSeats || 0} available)\n                    </p>\n                  </div>\n\n                  {bus.speed !== undefined && (\n                    <div>\n                      <p className=\"text-sm font-medium\">Speed</p>\n                      <p className=\"text-sm text-gray-600\">{bus.speed} km/h</p>\n                    </div>\n                  )}\n\n                  {bus.driver && (\n                    <div>\n                      <p className=\"text-sm font-medium\">Driver</p>\n                      <p className=\"text-sm text-gray-600\">{bus.driver.name}</p>\n                      {bus.driver.phoneNumber && (\n                        <p className=\"text-xs text-gray-500\">{bus.driver.phoneNumber}</p>\n                      )}\n                    </div>\n                  )}\n\n                  <div>\n                    <p className=\"text-xs text-gray-500\">\n                      Last updated: {new Date(bus.currentLocation.lastUpdated || Date.now()).toLocaleTimeString()}\n                    </p>\n                  </div>\n                </div>\n              </div>\n            </Popup>\n          </Marker>\n        ))}\n      </MapContainer>\n\n      {/* Map legend */}\n      <div className=\"absolute bottom-4 right-4 bg-white rounded-lg shadow-lg p-3 z-[1000]\">\n        <h4 className=\"text-sm font-semibold mb-2\">Legend</h4>\n        <div className=\"space-y-1\">\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-4 h-4 bg-green-500 rounded-full border-2 border-white\"></div>\n            <span className=\"text-xs\">Available</span>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-4 h-4 bg-yellow-500 rounded-full border-2 border-white\"></div>\n            <span className=\"text-xs\">Nearly Full</span>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-4 h-4 bg-red-500 rounded-full border-2 border-white\"></div>\n            <span className=\"text-xs\">Overcrowded</span>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <div className=\"w-4 h-4 bg-blue-500 rounded-full border-2 border-white\"></div>\n            <span className=\"text-xs\">Bus Stop</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}